?trainControl
##### setup project #####
setwd('/Users/ivan/Work_directory/Afr-Soil-Prediction')
library(caret)
train <- read.csv('data/training.csv', stringsAsFactor=F)
test <- read.csv('data/sorted_test.csv', stringsAsFactor=F)
dim(train)
# set y
y <- c('Ca', 'P', 'pH', 'SOC', 'Sand')
head(train[,y])
# pca
train_y <- train[,y]
train <- train[,-1]
train <- train[,-which(names(train) %in% y)]
train_Ca <- train
train_Ca$Ca <- train_y[,'Ca']
index <- createDataPartition(y = train_Ca$Ca, p=.8, list=F)
train_Ca_train <- train_Ca[index,]
train_Ca_test <- train_Ca[-index,]
dim(train_Ca_train)
dim(train_Ca_test)
?trainControl
?expand.grid
?train
cvControl <- trainControl(method="repeatedcv", number=10, repeats=5,
classProbs = F, allowParallel = TRUE, seeds=8888)
expand.grid(n.trees=c(500,1000,1500),shrinkage=.1,interaction.depth=c(5,10,15))
Grid <-expand.grid(n.trees=c(500,1000,1500),shrinkage=.1,interaction.depth=c(5,10,15))
?train
fit_Ca <- train(Ca~., data=train_Ca_train, method='gbm', metrix = 'RMSE',
trControl=cvControl, tuneGrid=Grid,
preProcess = c('center','scale', 'pca'))
cvControl <- trainControl(method="repeatedcv", number=10, repeats=5,
classProbs = F, allowParallel = TRUE)
Grid <-expand.grid(n.trees=c(500,1000,1500),shrinkage=.1,
interaction.depth=c(5,10,15))
fit_Ca <- train(Ca~., data=train_Ca_train, method='gbm',
trControl=cvControl, tuneGrid=Grid,
preProcess = c('center','scale', 'pca'))
fit_Ca
pred_Ca <- predict(fit_Ca, train_Ca_train)
confusionMatrix(pred_Ca, train_Ca_train$Ca)
identical(names(pred_Ca), names(train_Ca_train$Ca))
identical(str(pred_Ca), str(train_Ca_train$Ca))
confusionMatrix(pred_Ca, train_Ca_train$Ca)
table(pred_Ca, train_Ca_train$Ca)
pred_Ca
plot(fit_Ca)
pred_Ca <- predict(fit_Ca, train_Ca_test)
confusionMatrix(pred_Ca, train_Ca_test$Ca)
imp <- varImp(pred_Ca)
RMSE
RMSE(pred_Ca,train_Ca_test$Ca)
pred_Ca_t <- predict(fit_Ca, train_Ca_train)
RMSE(pred_Ca_t,train_Ca_train$Ca)
install.packages('GMM')
install.packages('gmm')
require(gmm)
gmm(Ca~., train_Ca_train)
gmm(Ca~., data=train_Ca_train)
?gmm
data(Finance)
str(Finance)
rm <- Finance[1:300, "rm"]
rf <- Finance[1:300, "rf"]
head(rm)
head(rf)
r <- Finance[1:300, 1:10]
z <- as.matrix(r-rf)
z
head(z)
head(r)
head(rf)
head(z)
t <- nrow(z)
t
zm <- rm-rf
head(zm)
h <- matrix(zm, t, 1)
h
head(zm)
res <- gmm(z ~ zm, x = h)
res
summary(res)
head(zm)
zm
z
h
zm
str(train_Ca_train)
dim(train_Ca_train)
dim(train_Ca_train)
train_Ca_train[,3595]
names(train_Ca_train[,3595])
names(train_Ca_train[,3594])
names(train_Ca_train[,1])
names(train_Ca_train)
z <- train_Ca_train$Ca
z
z <- train_Ca_train[, 1:3594]
zm <- train_Ca_train[,3595]
head(z)
zm <- matrix(train_Ca_train[,3595], nrow(z), 1)
zm
res <- gmm(z ~ zm, x = h)
z <- as.matrix(train_Ca_train[, 1:3594])
zm <- matrix(train_Ca_train[,3595], nrow(z), 1)
res <- gmm(z ~ zm, x = h)
RMSE(pred_Ca_t,train_Ca_train$Ca)
RMSE(pred_Ca,train_Ca_test$Ca) ## 0.1350805
zm <- as.matrix(train_Ca_train[,3595])
head(h)
res <- gmm(z ~ zm, x = train_Ca_train)
z <- as.matrix(train_Ca_train[, 1:3594])
zm <- as.matrix(train_Ca_train[,3595])
res <- gmm(z ~ zm, x = train_Ca_train)
nrow(zm)
nrow(z)
nrow(train_Ca_train)
res <- gmm(z ~ zm, x = as.matrix(train_Ca_train))
